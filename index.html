<html>
	<head>
		<title>BOD Attendance</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="initial-scale=1, minimal-ui" />
		
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css">
		<script src="https://cdn.jsdelivr.net/npm/dayjs@1.8.23/dayjs.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/dayjs@1.8.23/plugin/isBetween.js"></script>
		<script>
			function checkRefresh() {
			    if (document.refreshForm.visited.value == "") {
			        // This is a fresh page load
			        document.refreshForm.visited.value = "1";
			        // You may want to add code here special for
			        // fresh page loads
							console.log("fresh page load");
			    } else {
			        // This is a page refresh
			        // Insert code here representing what to do on
			        // a refresh
						console.log("page refresh");
			    }
			}
		</script>
		<style>
			:root {
				--green: #55efc4;
				--red: #ff7675;
			}
			.f-modal-alert {
			  
			}

			.f-modal-alert .f-modal-icon {
			  border-radius: 50%;
			  border: 4px solid gray;
			  box-sizing: content-box;
			  height: 80px;
			  margin: 20px auto;
			  padding: 0;
			  position: relative;
			  width: 80px;
			}
			.f-modal-alert .f-modal-icon.f-modal-success, .f-modal-alert .f-modal-icon.f-modal-error {
			  border-color: var(--green);
			}
			.f-modal-alert .f-modal-icon.f-modal-success:after, .f-modal-alert .f-modal-icon.f-modal-success:before, .f-modal-alert .f-modal-icon.f-modal-error:after, .f-modal-alert .f-modal-icon.f-modal-error:before {
			  background: #fff;
			  content: '';
			  height: 120px;
			  position: absolute;
			  -webkit-transform: rotate(45deg);
			          transform: rotate(45deg);
			  width: 60px;
			}
			.f-modal-alert .f-modal-icon.f-modal-success:before, .f-modal-alert .f-modal-icon.f-modal-error:before {
			  border-radius: 120px 0 0 120px;
			  left: -33px;
			  top: -7px;
			  -webkit-transform-origin: 60px 60px;
			          transform-origin: 60px 60px;
			  -webkit-transform: rotate(-45deg);
			          transform: rotate(-45deg);
			}
			.f-modal-alert .f-modal-icon.f-modal-success:after, .f-modal-alert .f-modal-icon.f-modal-error:after {
			  border-radius: 0 120px 120px 0;
			  left: 30px;
			  top: -11px;
			  -webkit-transform-origin: 0 60px;
			          transform-origin: 0 60px;
			  -webkit-transform: rotate(-45deg);
			          transform: rotate(-45deg);
			}
			.f-modal-alert .f-modal-icon.f-modal-success .f-modal-placeholder, .f-modal-alert .f-modal-icon.f-modal-error .f-modal-placeholder {
			  border-radius: 50%;
/*			  border: 4px solid rgba(165, 220, 134, 0.2);*/
				border: 4px solid rgba(85, 239, 196, 0.2);
			  box-sizing: content-box;
			  height: 80px;
			  left: -4px;
			  position: absolute;
			  top: -4px;
			  width: 80px;
			  z-index: 2;
			}
			.f-modal-alert .f-modal-icon.f-modal-success .f-modal-fix, .f-modal-alert .f-modal-icon.f-modal-error .f-modal-fix {
			  background-color: #fff;
			  height: 90px;
			  left: 28px;
			  position: absolute;
			  top: 8px;
			  -webkit-transform: rotate(-45deg);
			          transform: rotate(-45deg);
			  width: 5px;
			  z-index: 1;
			}
			.f-modal-alert .f-modal-icon.f-modal-success .f-modal-line, .f-modal-alert .f-modal-icon.f-modal-error .f-modal-line {
			  background-color: var(--green);
			  border-radius: 2px;
			  display: block;
			  height: 5px;
			  position: absolute;
			  z-index: 2;
			}
			.f-modal-alert .f-modal-icon.f-modal-success .f-modal-line.f-modal-tip, .f-modal-alert .f-modal-icon.f-modal-error .f-modal-line.f-modal-tip {
			  left: 14px;
			  top: 46px;
			  -webkit-transform: rotate(45deg);
			          transform: rotate(45deg);
			  width: 25px;
			}
			.f-modal-alert .f-modal-icon.f-modal-success .f-modal-line.f-modal-long, .f-modal-alert .f-modal-icon.f-modal-error .f-modal-line.f-modal-long {
			  right: 8px;
			  top: 38px;
			  -webkit-transform: rotate(-45deg);
			          transform: rotate(-45deg);
			  width: 47px;
			}
			.f-modal-alert .f-modal-icon.f-modal-error {
			  border-color: var(--red);
			}
			.f-modal-alert .f-modal-icon.f-modal-error .f-modal-x-mark {
			  display: block;
			  position: relative;
			  z-index: 2;
			}
			.f-modal-alert .f-modal-icon.f-modal-error .f-modal-placeholder {
/*			  border: 4px solid rgba(200, 0, 0, 0.2);*/
				border: 4px solid rgba(255, 118, 117, 0.2);
			}
			.f-modal-alert .f-modal-icon.f-modal-error .f-modal-line {
			  background-color: var(--red);
			  top: 37px;
			  width: 47px;
			}
			.f-modal-alert .f-modal-icon.f-modal-error .f-modal-line.f-modal-left {
			  left: 17px;
			  -webkit-transform: rotate(45deg);
			          transform: rotate(45deg);
			}
			.f-modal-alert .f-modal-icon.f-modal-error .f-modal-line.f-modal-right {
			  right: 16px;
			  -webkit-transform: rotate(-45deg);
			          transform: rotate(-45deg);
			}
			.f-modal-alert .f-modal-icon.f-modal-warning {
			  border-color: #F8BB86;
			}
			.f-modal-alert .f-modal-icon.f-modal-warning:before {
			  -webkit-animation: pulseWarning 2s linear infinite;
			          animation: pulseWarning 2s linear infinite;
			  background-color: #fff;
			  border-radius: 50%;
			  content: "";
			  display: inline-block;
			  height: 100%;
			  opacity: 0;
			  position: absolute;
			  width: 100%;
			}
			.f-modal-alert .f-modal-icon.f-modal-warning:after {
			  background-color: #fff;
			  border-radius: 50%;
			  content: '';
			  display: block;
			  height: 100%;
			  position: absolute;
			  width: 100%;
			  z-index: 1;
			}
			.f-modal-alert .f-modal-icon.f-modal-warning .f-modal-body {
			  background-color: #F8BB86;
			  border-radius: 2px;
			  height: 47px;
			  left: 50%;
			  margin-left: -2px;
			  position: absolute;
			  top: 10px;
			  width: 5px;
			  z-index: 2;
			}
			.f-modal-alert .f-modal-icon.f-modal-warning .f-modal-dot {
			  background-color: #F8BB86;
			  border-radius: 50%;
			  bottom: 10px;
			  height: 7px;
			  left: 50%;
			  margin-left: -3px;
			  position: absolute;
			  width: 7px;
			  z-index: 2;
			}
			.f-modal-alert .f-modal-icon + .f-modal-icon {
/*			  margin-top: 50px;*/
			}

			.animateSuccessTip {
			  -webkit-animation: animateSuccessTip .75s;
			          animation: animateSuccessTip .75s;
			}

			.animateSuccessLong {
			  -webkit-animation: animateSuccessLong .75s;
			          animation: animateSuccessLong .75s;
			}

			.f-modal-icon.f-modal-success.animate:after {
			  -webkit-animation: rotatePlaceholder 4.25s ease-in;
			          animation: rotatePlaceholder 4.25s ease-in;
			}

			.f-modal-icon.f-modal-error.animate:after {
			  -webkit-animation: rotatePlaceholder 4.25s ease-in;
			          animation: rotatePlaceholder 4.25s ease-in;
			}

			.animateErrorIcon {
			  -webkit-animation: animateErrorIcon .5s;
			          animation: animateErrorIcon .5s;
			}

			.animateXLeft {
			  -webkit-animation: animateXLeft .75s;
			          animation: animateXLeft .75s;
			}

			.animateXRight {
			  -webkit-animation: animateXRight .75s;
			          animation: animateXRight .75s;
			}

			.scaleWarning {
			  -webkit-animation: scaleWarning 0.75s infinite alternate;
			          animation: scaleWarning 0.75s infinite alternate;
			}

			.pulseWarningIns {
			  -webkit-animation: pulseWarningIns 0.75s infinite alternate;
			          animation: pulseWarningIns 0.75s infinite alternate;
			}

			@-webkit-keyframes animateSuccessTip {
			  0%,54% {
			    width: 0;
			    left: 1px;
			    top: 19px;
			  }
			  70% {
			    width: 50px;
			    left: -8px;
			    top: 37px;
			  }
			  84% {
			    width: 17px;
			    left: 21px;
			    top: 48px;
			  }
			  100% {
			    width: 25px;
			    left: 14px;
			    top: 45px;
			  }
			}

			@keyframes animateSuccessTip {
			  0%,54% {
			    width: 0;
			    left: 1px;
			    top: 19px;
			  }
			  70% {
			    width: 50px;
			    left: -8px;
			    top: 37px;
			  }
			  84% {
			    width: 17px;
			    left: 21px;
			    top: 48px;
			  }
			  100% {
			    width: 25px;
			    left: 14px;
			    top: 45px;
			  }
			}
			@-webkit-keyframes animateSuccessLong {
			  0%,65% {
			    width: 0;
			    right: 46px;
			    top: 54px;
			  }
			  84% {
			    width: 55px;
			    right: 0;
			    top: 35px;
			  }
			  100% {
			    width: 47px;
			    right: 8px;
			    top: 38px;
			  }
			}
			@keyframes animateSuccessLong {
			  0%,65% {
			    width: 0;
			    right: 46px;
			    top: 54px;
			  }
			  84% {
			    width: 55px;
			    right: 0;
			    top: 35px;
			  }
			  100% {
			    width: 47px;
			    right: 8px;
			    top: 38px;
			  }
			}
			@-webkit-keyframes rotatePlaceholder {
			  0%,5% {
			    -webkit-transform: rotate(-45deg);
			            transform: rotate(-45deg);
			  }
			  100%,12% {
			    -webkit-transform: rotate(-405deg);
			            transform: rotate(-405deg);
			  }
			}
			@keyframes rotatePlaceholder {
			  0%,5% {
			    -webkit-transform: rotate(-45deg);
			            transform: rotate(-45deg);
			  }
			  100%,12% {
			    -webkit-transform: rotate(-405deg);
			            transform: rotate(-405deg);
			  }
			}
			@-webkit-keyframes animateErrorIcon {
			  0% {
			    -webkit-transform: rotateX(100deg);
			            transform: rotateX(100deg);
			    opacity: 0;
			  }
			  100% {
			    -webkit-transform: rotateX(0deg);
			            transform: rotateX(0deg);
			    opacity: 1;
			  }
			}
			@keyframes animateErrorIcon {
			  0% {
			    -webkit-transform: rotateX(100deg);
			            transform: rotateX(100deg);
			    opacity: 0;
			  }
			  100% {
			    -webkit-transform: rotateX(0deg);
			            transform: rotateX(0deg);
			    opacity: 1;
			  }
			}
			@-webkit-keyframes animateXLeft {
			  0%,
				65% {
			    left: 82px;
			    top: 95px;
			    width: 0;
			  }
			  84% {
			    left: 14px;
			    top: 33px;
			    width: 47px;
			  }
			  100% {
			    left: 17px;
			    top: 37px;
			    width: 47px;
			  }
			}
			@keyframes animateXLeft {
			  0%,
				65% {
			    left: 82px;
			    top: 95px;
			    width: 0;
			  }
			  84% {
			    left: 14px;
			    top: 33px;
			    width: 47px;
			  }
			  100% {
			    left: 17px;
			    top: 37px;
			    width: 47px;
			  }
			}
			@-webkit-keyframes animateXRight {
			  0%,
				65% {
			    right: 82px;
			    top: 95px;
			    width: 0;
			  }
			  84% {
			    right: 14px;
			    top: 33px;
			    width: 47px;
			  }
			  100% {
			    right: 16px;
			    top: 37px;
			    width: 47px;
			  }
			}
			@keyframes animateXRight {
			  0%,
				65% {
			    right: 82px;
			    top: 95px;
			    width: 0;
			  }
			  84% {
			    right: 14px;
			    top: 33px;
			    width: 47px;
			  }
			  100% {
			    right: 16px;
			    top: 37px;
			    width: 47px;
			  }
			}
			@-webkit-keyframes scaleWarning {
			  0% {
			    -webkit-transform: scale(1);
			            transform: scale(1);
			  }
			  30% {
			    -webkit-transform: scale(1.02);
			            transform: scale(1.02);
			  }
			  100% {
			    -webkit-transform: scale(1);
			            transform: scale(1);
			  }
			}
			@keyframes scaleWarning {
			  0% {
			    -webkit-transform: scale(1);
			            transform: scale(1);
			  }
			  30% {
			    -webkit-transform: scale(1.02);
			            transform: scale(1.02);
			  }
			  100% {
			    -webkit-transform: scale(1);
			            transform: scale(1);
			  }
			}
			@-webkit-keyframes pulseWarning {
			  0% {
			    background-color: #fff;
			    -webkit-transform: scale(1);
			            transform: scale(1);
			    opacity: 0.5;
			  }
			  30% {
			    background-color: #fff;
			    -webkit-transform: scale(1);
			            transform: scale(1);
			    opacity: 0.5;
			  }
			  100% {
			    background-color: #F8BB86;
			    -webkit-transform: scale(2);
			            transform: scale(2);
			    opacity: 0;
			  }
			}
			@keyframes pulseWarning {
			  0% {
			    background-color: #fff;
			    -webkit-transform: scale(1);
			            transform: scale(1);
			    opacity: 0.5;
			  }
			  30% {
			    background-color: #fff;
			    -webkit-transform: scale(1);
			            transform: scale(1);
			    opacity: 0.5;
			  }
			  100% {
			    background-color: #F8BB86;
			    -webkit-transform: scale(2);
			            transform: scale(2);
			    opacity: 0;
			  }
			}
			@-webkit-keyframes pulseWarningIns {
			  0% {
			    background-color: #F8D486;
			  }
			  100% {
			    background-color: #F8BB86;
			  }
			}
			@keyframes pulseWarningIns {
			  0% {
			    background-color: #F8D486;
			  }
			  100% {
			    background-color: #F8BB86;
			  }
			}
		</style>
		<style>
			body {
				font-family: GillSans, Calibri, Trebuchet, sans-serif;
				font-size: 16px;
			}
			#wrap {
				position: absolute;
				height: 300px;
				width: 80%;
				margin: -150px 0 0 -40%;
				top: 50%;
				left: 50%;
			}
			@media screen and (min-width: 680px) {
				#wrap {
					position: absolute;
					height: 340px;
					width: 400px;
					margin: -170px 0 0 -200px;
					top: 50%;
					left: 50%;
				}
			}
			.f-modal-alert {
				margin-bottom: 2em;
			}
			.f-modal-success {
				display: none;
			}
			.f-modal-error {
				display: none;
			}
			#time-now {
				border-width: 2px;
				font-weight: bold;
			}
			p {
				text-align: center;
			}
			#message, #sub-message {
				font-weight: bold;
			}
			#course, #period {
				color: #b2bec3;
			}
			
			#times {
				position: relative;
				display: flex;
				align-items: center;
				font-size: 14px;
			}
			.time {
				border: 1px solid #b2bec3;
				line-height: 1.375;
				padding-left: 1.5rem;
				padding-right: 1.5rem;
				color: #b2bec3;
				padding: .25rem;
				background-color: white;
				border-radius: 4px;
			}
			.success {
				color: #55efc4;
				border-color: #55efc4;
			}
			.error {
				color: #ff7675;
				border-color: #ff7675;
			}
			.before {
				margin-right: 2rem;
			}
			.after {
				margin-left: 2rem;
			}
			.line {
			  content: '';
			  flex: 1;  
			  height: 1px;
			  background-color: #b2bec3;
			  display: block;
			}
			.line-success {
				background-color: #55efc4;
			}
			#note {
				margin-top: 2em;
				font-size: 90%;
				line-height: 1.25;
			}
		</style>
	</head>
	<body onLoad="javascript:checkRefresh();">
		
		<div id="wrap">
			<div class="f-modal-alert">
				<div class="f-modal-icon f-modal-error animate">
					<span class="f-modal-x-mark">
						<span class="f-modal-line f-modal-left animateXLeft"></span>
						<span class="f-modal-line f-modal-right animateXRight"></span>
					</span>
					<div class="f-modal-placeholder"></div>
					<div class="f-modal-fix"></div>
				</div>
				
				<div class="f-modal-icon f-modal-success animate">
					<span class="f-modal-line f-modal-tip animateSuccessTip"></span>
					<span class="f-modal-line f-modal-long animateSuccessLong"></span>
					<div class="f-modal-placeholder"></div>
					<div class="f-modal-fix"></div>
				</div>
			</div>
			<p id="message"></p>
			<p id="sub-message"></p>
			
			<p id="course" class="info">AP Computer Science A</p>
			<p id="period" class="info">Period 7</p>
			<p id ="times"></p>
			<p id="note"><strong>Note: Do not refresh this page.</strong><br>You must click the attendance link from<br>Schoology for your attendance to count</p>
		</div>

		<form name="refreshForm">
		 <input type="hidden" name="visited" value="" />
	 	</form>
	
	<!-- <main class="site__content island" role="content">
	  <div class="wrap">
	    <p class="meta"><button id="go-back" class="butt">Back To Course Page</button></p>
	    <p><small></small></p>
	  </div>
	</main> -->
	
	<script>
		const schedule = {
			'3/27/20':'gold',
			'3/30/20':'black',
			'3/31/20':'gold',
			'4/1/20':'black',
			'4/2/20':'gold',
			'4/20/20':'black',
			'4/21/20':'gold',
			'4/22/20':'black',
			'4/23/20':'gold',
			'4/24/20':'black',
			'4/27/20':'gold',
			'4/28/20':'black',
			'4/29/20':'gold',
			'4/30/20':'black',
			'5/1/20':'gold'
		}
		const bell_schedule = { black: [ { period:"1", start:"8:30 AM", end:"9:50 AM" }, { period:"2", start:"10:05 AM", end:"11:25 AM" }, { period:"3", start:"12:05 PM", end:"1:25 PM"
		}, { period:"4", start:"1:40 PM", end:"3:00 PM" }, ], gold: [ { period:"5", start:"8:30 AM", end:"9:50 AM" }, { period:"6", start:"10:05 AM", end:"11:25 AM" }, { period:"7",
		start:"12:05 PM", end:"1:25 PM" }, { period:"8", start:"1:40 PM", end:"3:00 PM" }, ], }
		dayjs.extend(window.dayjs_plugin_isBetween);
		
		const urlParams = new URLSearchParams(window.location.search);
		const c = atob(urlParams.get('c')).split(';');
		document.querySelector('#course').innerHTML = c[0];
		document.querySelector('#period').innerHTML = 'Period ' + c[1];
		const now = dayjs();
		const today = now.format('M/D/YY');
		
		// const today = '3/31/20';
		// const now = dayjs(today + ' ' + '1:25 PM', 'M/D/YY h:mm A');
		
		let metToday = false;
		if (today in schedule) {
			const bell = schedule[today];
			bell_schedule[bell].forEach(x => {
				if (x.period == c[1]) {
					metToday = true;
					console.log('Period: ' + c[1]);
					console.log('Now: ' + now.format('h:mm A'))
					start = dayjs(today + ' ' + x.start, 'M/D/YY h:mm A');
					console.log('Start: ' + start.format('h:mm A'));
					end = dayjs(today + ' ' + x.end, 'M/D/YY h:mm A');
					console.log('End: ' + end.format('h:mm A'));
				
					html = '';
					if (now.isBetween(start, end, null, '[]')) {
						document.querySelector('.f-modal-success').style.display = 'block';
						document.querySelector('#message').innerHTML = 'Attendance Recorded';
						document.querySelector('#message').classList.add('success');
						
						html += '<span id="time-start" class="time success">' + start.format('h:mm A') + '</span>';
						html += '<div class="line line-success"></div>';
						html += '<span id="time-now" class="time success">' + now.format('h:mm A') + '</span>';
						html += '<div class="line line-success"></div>';
						html += '<span id="time-end" class="time success">' + end.format('h:mm A') + '</span>';
					} else {
						document.querySelector('.f-modal-error').style.display = 'block';
						document.querySelector('#message').classList.add('error');
						document.querySelector('#sub-message').classList.add('error');
						if (now.isBefore(start)) {
							document.querySelector('#message').innerHTML = 'Class has not started yet';
							html += '<span id="time-now" class="time error before">' + now.format('h:mm A') + '</span>';
							html += '<span id="time-start" class="time">' + start.format('h:mm A') + '</span>';
							html += '<div class="line"></div>';
							html += '<span id="time-end" class="time">' + end.format('h:mm A') + '</span>';
						} else if (now.isAfter(end)) {
							document.querySelector('#message').innerHTML = 'Class is over';
							html += '<span id="time-start" class="time">' + start.format('h:mm A') + '</span>';
							html += '<div class="line"></div>';
							html += '<span id="time-end" class="time">' + end.format('h:mm A') + '</span>';
							html += '<span id="time-now" class="time error after">' + now.format('h:mm A') + '</span>';
						}
					}
					document.querySelector('#times').innerHTML = html;
				}
			});
			
		} else {
			document.querySelector('.f-modal-error').style.display = 'block';
			document.querySelector('#message').innerHTML = 'No Class Today';
			document.querySelector('#message').classList.add('error');
		}
		if (!metToday) {
			document.querySelector('.f-modal-error').style.display = 'block';
			document.querySelector('#message').innerHTML = 'No Class Today';
			document.querySelector('#message').classList.add('error');
		}
		
		// document.querySelector('#go-back').addEventListener('click', e => {
		// 	history.back();
		// })
	</script>
	</body>
</html>